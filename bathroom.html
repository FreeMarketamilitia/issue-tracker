<!-- bathroom.html (included by sidebar.html) -->
<style>
  .container-fluid {
    padding-top: 20px;
  }
  #scanner-container {
    position: relative;
  }
  #qr-reader {
    width: 100%;
  }
  #qr-reader-results {
    margin-top: 20px;
  }
</style>

<div id="mainBathroom" class="main">
  <div class="container-fluid">
    <h4>Bathroom Break Scanner</h4>
    <div id="scanner-container">
      <div id="qr-reader" style="width: 500px"></div>
      <div id="qr-reader-results"></div>
    </div>
  </div>
</div>

<script src="https://unpkg.com/html5-qrcode"></script>
<script>
  function onScanSuccess(decodedText, decodedResult) {
    console.log(`Scan result: ${decodedText}`, decodedResult);
    document.getElementById('qr-reader-results').innerText = `Last scan: ${decodedText}`;
    google.script.run
      .withSuccessHandler(updateUI)
      .withFailureHandler(showError)
      .processBarcode(decodedText);
  }

  function updateUI(message) {
    alert(message);
    if (typeof renderBathroomAnalytics === 'function') {
      renderBathroomAnalytics();
    }
  }

  function showError(error) {
    alert(error.message);
  }

  const html5QrcodeScanner = new Html5QrcodeScanner('qr-reader', { fps: 10, qrbox: 250 });
  html5QrcodeScanner.render(onScanSuccess);
</script>

